version: "3.1"
session_config:
  session_expiration_time: 60
  carry_over_slots_to_new_session: true

intents:
  - affirm
  - bot_challenge
  - deny
  - goodbye
  - greet
  - request_doc_register
  - request_do_register
  # - request_historic
  - request_email
  - request_classes
  - request_calendar:
      ignore_entities:
        - PER
  - request_courses
  - request_redo_register
  - inform_name:
      ignore_entities:
        - LOC
  - inform_professor_name:
      ignore_entities:
        - LOC
  - ask_what_bot_do
  - modality
  - courses
  - ingress_modality
  - request_requirements
  - req_students

entities:
  - PER
  - LOC
  - register
  - classes
  - calendar
  - courses
  - documents
  - courses_modality
  - courses_name
  - ingress_modality
  - request_redo_register
  - courses_modality_link
  - requirements

slots:
  # teste validar nome
  name:
    type: text
    influence_conversation: true
    mappings:
      - type: from_entity
        intent: inform_name
        entity: PER
        and:
          - not_intent: inform_professor_name
          - not_intent: greet
        conditions:
          - active_loop: name_form
            requested_slot: name
  professor_name:
    type: text
    influence_conversation: true
    mappings:
      - type: from_entity
        entity: PER
        intent: inform_professor_name
        not_intent: inform_name
        conditions:
          - active_loop: professor_name_form
            requested_slot: professor_name
  classes:
    type: text
    mappings:
      - type: from_entity
        entity: classes
        conditions:
          - active_loop: classes_form
  calendar:
    type: text
    mappings:
      - type: from_entity
        entity: calendar
        conditions:
          - active_loop: calendar_form

  #forms action get course
  courses_name:
    type: text
    influence_conversation: true
    mappings:
      - type: from_entity
        entity: courses_name
  courses_modality:
    influence_conversation: true
    type: text
    mappings:
      - type: from_entity
        entity: courses_modality
  courses_modality_link:
    type: text
    mappings:
      - type: from_entity
        entity: courses_modality_link

  documents:
    type: text
    mappings:
      - type: from_entity
        entity: documents
        conditions:
          - active_loop: documents_form
  requirements:
    type: text
    mappings:
      - type: from_entity
        entity: requirements

  ingress_modality:
    type: text
    mappings:
      - type: from_entity
        entity: ingress_modality

forms:
  name_form:
    ignored_intents:
      - greet
      - inform_professor_name
    required_slots:
      - name
  professor_name_form:
    ignored_intents:
      - greet
      - inform_name
    required_slots:
      - professor_name
  classes_form:
    required_slots:
      - classes
  calendar_form:
    required_slots:
      - calendar
  documents_form:
    required_slots:
      - documents
  requirement_form:
    required_slots:
      - requirements

responses:
  utter_greet:
    - text: Eai, seja bem-vindo :)
    - text: Ol√°, seja bem-vindo :)
  utter_examples:
    - text: Me pergunte o que fa√ßo para ver algumas op√ß√µes
  utter_ask_name:
    - text: Qual √© seu nome?
    - text: Me informa seu nome?
  utter_ask_professor_name:
    - text: Qual o nome do professor?
    - text: Me informa o nome do professor?
  utter_ask_help:
    - text: Em que posso ajudar {name}?
  utter_goodbye:
    - text: At√© logo, {name}! :)
  utter_iamabot:
    - text: I am a bot, powered by Rasa.
  utter_ask_classes:
    - text: Os hor√°rios de suas aulas e disciplinas voc√™ pode conferir aqui!
  utter_ask_calendar:
    - text: Confira aqui seu calend√°rio acad√™mico!
  utter_ask_courses:
    - text: Os cursos dispon√≠veis no IFRS campus Rio Grande pode ser visualizados aqui!
  utter_ask_documents:
    - text: Estes s√£o os documentos que voc√™ precisa manter atualizados no IFRS = CPF, Comprovante de resid√™ncia e dados cadastrais!
  utter_req_to_ask:
    - text: Pode dizer ou ent√£o me pergunte o que posso fazer!

  # utter buttons
  utter_ask_more_help:
    - buttons:
        - payload: /affirm
          title: Sim
        - payload: /deny
          title: N√£o
      button_type: inline
      text: Gostaria de mais alguma ajuda?
  utter_ask_courses_modality:
    - text: Para qual modalidade gostaria de informa√ß√µes?
      buttons:
        - title: T√©cnicos integrados
          payload: '/modality{{"courses_modality":"integrado"}}'
        - title: T√©cnicos subsequente
          payload: '/modality{{"courses_modality":"subsequente"}}'
        - title: Superiores
          payload: '/modality{{"courses_modality":"superior"}}'
      button_type: vertical
  utter_ask_ingress_modality:
    - text: Qual a forma de ingresso?
      buttons:
        - title: Enem
          payload: '/ingress_modality{{"ingress_modality":"Enem"}}'
        - title: Processo seletivo EJA
          payload: '/ingress_modality{{"ingress_modality":"Processo seletivo EJA"}}'
        - title: Prova
          payload: '/ingress_modality{{"ingress_modality":"Prova"}}'
        - title: PS ind√≠gena
          payload: '/ingress_modality{{"ingress_modality":"PS ind√≠gena"}}'
        - title: Sorteio
          payload: '/ingress_modality{{"ingress_modality":"Sorteio"}}'
      button_type: vertical
  utter_ask_redo_register:
    - text: Qual a modalidade do curso que voc√™ quer fazer a rematr√≠cula? 
      buttons:
        - title: T√©cnicos integrados
          payload: '/modality{{"courses_modality":"integrado"}}'
        - title: T√©cnicos subsequente
          payload: '/modality{{"courses_modality":"subsequente"}}'
        - title: Superiores
          payload: '/modality{{"courses_modality":"superior"}}'
  utter_ask_requirements:
    - text: Qual requerimento tu precisa? üìÉ
      buttons:
        - title: Aproveitamento de Estudos
          payload: '/req_students{{"requirements":"aproveitamento de estudos"}}'
        - title: Atividades Complementares 
          payload: '/req_students{{"requirements":"atividades complementares"}}'
        - title: Cancelamento de Matr√≠cula
          payload: '/req_students{{"requirements":"cancelamento de matr√≠cula"}}'
        - title: Certifica√ß√£o de Conhecimentos
          payload: '/req_students{{"requirements":"certifica√ß√£o de conhecimento"}}'
        - title: Justificativa de Falta / Segunda Chamada
          payload: '/req_students{{"requirements":"justificativa de falta"}}'
        - title: Quebra de Pr√©-Requisito 
          payload: '/req_students{{"requirements":"quebra de pr√©-requisito"}}'
        - title: Reingresso
          payload: '/req_students{{"requirements":"reingresso"}}'
        - title: Trancamento de Disciplina
          payload: '/req_students{{"requirements":"trancamento de disciplina"}}'
        - title: Trancamento de Matr√≠cula
          payload: '/req_students{{"requirements":"trancamento de matr√≠cula"}}'
      button_type: vertical
      

actions:
  - utter_ask_help
  - utter_goodbye
  - utter_greet
  - utter_ask_classes
  - utter_ask_calendar
  - utter_ask_courses
  - utter_ask_documents

  # custom actions
  - action_get_professor_contact
  - action_get_doc_register
  - action_get_classes
  - action_get_calendar
  - action_get_courses
  - action_get_info_course
  - action_inform_do_register
  - action_inform_redo_register
  - action_system_type
  - action_what_bot_do
  - action_goodbye_and_clear_slots
  - action_get_requirements

  # custom validation
  - validate_name_form
  - validate_professor_name_form